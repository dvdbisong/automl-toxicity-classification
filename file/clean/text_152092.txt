hai Subject 

To determine the best way to test for a feature refer to the documentation for the feature of interest The following list discusses some common techniques for feature detection
You can test for the presence of the functions associated with a feature To test for the presence of a function in a system DLL call the LoadLibrary function to load the DLL Then call the GetProcAddress function to determine whether the function of interest is present in the DLL Use the pointer returned by GetProcAddress to call the function Note that even if the function is present it may be a stub that just returns an error code such as ERROR_CALL_NOT_IMPLEMENTED
You can determine the presence of some features by using the GetSystemMetrics function For example you can detect multiple display monitors by calling GetSystemMetricsSM_CMONITORS
There are several versions of the redistributable DLLs that implement shell and common control features For information about determining which versions are present on the system your application is running on see the topic Shell and Common Controls Versions
If you must require a particular operating system be sure to use it as a minimum supported version rather than design the test for the one operating system This way your detection code will continue to work on future versions of Windows